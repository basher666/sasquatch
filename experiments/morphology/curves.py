from pylab import *
import math
import numpy as np
import numpy.numarray as na
import random
from scipy.stats import sem
import matplotlib.patches as mpatches
from matplotlib import rcParams


rcParams.update({'figure.autolayout': True})


soft_7 = [(-98512.398000,-100372.281000),
          (-151156.977000,-154911.231000),
          (-125449.886000,-127202.266000),
          (-126354.049000,-129193.741000),
          (-104152.243000,-105952.075000),
          (-170755.688000,-172686.313000),
          (-163904.353000,-166883.865000),
          (-125449.886000,-127202.266000),
          (-165984.233000,-164977.915000),
          (-145341.197000,-146696.961000),
          (-131598.161000,-134257.241000),
          (-141799.577000,-144813.740000)]
sz = len(soft_7)


soft_5 = random.sample([(-104152.243000,-105952.075000),
                        (-120617.104000,-122442.316000),
                        (-196023.595000,-196359.631000),
                        (-167524.556000,-167277.392000),
                        (-191430.403000,-193330.881000),
                        (-201704.839000,-201645.468000),
                        (-237631.983000,-236890.984000),
                        (-222473.941000,-221187.086000),
                        (-169084.862000,-167755.542000),
                        (-167524.556000,-167277.392000),
                        (-151156.977000,-154911.231000),
                        (-167524.556000,-167277.392000),
                        (-160551.646000,-163450.451000),
                        (-136842.368000,-139320.817000),
                        (-141799.577000,-144813.740000),
                        (-147737.573000,-151441.739000),
                        (-159753.259000,-159485.607000),
                        (-171066.157000,-169160.591000),
                        (-273211.946000,-270737.338000),
                        (-104152.243000,-105952.075000),
                        (-176850.986000,-172843.060000),
                        (-125449.886000,-127202.266000),
                        (-163904.353000,-166883.865000),
                        (-148458.825000,-151263.866000),
                        (-151156.977000,-154911.231000)],sz)

hard_6 = [(-146815.050000,-146297.207000),
          (-191199.638000,-189830.667000),
          (-109792.163000,-111531.948000),
          (-175461.928000,-171591.675000),
          (-125449.886000,-127202.266000),
          (-163904.353000,-166883.865000),
          (-168943.628000,-169397.129000),
          (-206273.895000,-208733.568000),
          (-155966.095000,-158906.201000),
          (-98512.398000,-100372.281000),
          (-175461.928000,-171591.675000),
          (-141799.577000,-144813.740000),
          (-160914.123000,-160617.598000),
          (-125449.886000,-127202.266000),
          (-285184.121000,-284281.137000),
          (-182630.355000,-177551.636000),
          (-164009.614000,-162646.799000),
          (-121556.447000,-118624.185000),
          (-221062.752000,-220277.987000),
          (-116543.917000,-118268.997000),
          (-163904.353000,-166883.865000),
          (-98512.398000,-100372.281000),
          (-104152.243000,-105952.075000),
          (-159542.275000,-161283.165000),
          (-172791.422000,-171700.387000),
          (-141799.577000,-144813.740000)]
soft_6 = random.sample([(-167819.324000,-169051.878000),
                        (-215615.633000,-211559.645000),
                        (-228827.241000,-229807.241000),
                        (-190828.367000,-193113.569000),
                        (-151156.977000,-154911.231000),
                        (-148166.643000,-148644.873000),
                        (-152572.184000,-155363.948000),
                        (-193454.332000,-189295.312000),
                        (-191199.638000,-189830.667000),
                        (-136518.369000,-139992.772000),
                        (-215421.090000,-214265.268000),
                        (-214860.177000,-213292.944000),
                        (-141799.577000,-144813.740000),
                        (-129203.369000,-127001.670000),
                        (-125449.886000,-127202.266000),
                        (-125449.886000,-127202.266000),
                        (-155966.095000,-158906.201000),
                        (-136808.204000,-137923.508000),
                        (-160914.123000,-160617.598000),
                        (-142678.964000,-145600.089000),
                        (-231770.781000,-231876.742000),
                        (-159685.744000,-160376.395000),
                        (-143218.719000,-146933.567000),
                        (-135711.449000,-139291.232000),
                        (-104152.243000,-105952.075000),
                        (-166588.427000,-166065.461000),
                        (-169325.627000,-171260.756000)],sz)

hard_2 = [(-313655.997000,-310182.396000),
          (-330522.395000,-326155.223000),
          (-276066.554000,-276562.674000),
          (-253875.557000,-253946.867000),
          (-295986.250000,-294808.240000),
          (-293919.015000,-289968.754000),
          (-163904.353000,-166883.865000),
          (-231264.917000,-233059.851000),
          (-163904.353000,-166883.865000),
          (-450263.390000,-447368.727000),
          (-234838.846000,-232699.755000),
          (-189629.262000,-189347.427000),
          (-231770.781000,-231876.742000),
          (-256280.929000,-255916.931000),
          (-253875.557000,-253946.867000),
          (-163904.353000,-166883.865000),
          (-330522.395000,-326155.223000),
          (-191430.403000,-193330.881000),
          (-283116.993000,-280921.624000),
          (-163904.353000,-166883.865000),
          (-293565.603000,-293499.478000),
          (-291551.187000,-288112.270000),
          (-230802.081000,-232239.015000),
          (-237631.983000,-236890.984000),
          (-220871.274000,-221579.254000),
          (-234838.846000,-232699.755000),
          (-234838.846000,-232699.755000),
          (-231770.781000,-231876.742000),
          (-189629.262000,-189347.427000),
          (-306436.969000,-309540.723000),
          (-291551.187000,-288112.270000),
          (-330522.395000,-326155.223000),
          (-253875.557000,-253946.867000),
          (-293919.015000,-289968.754000),
          (-328275.500000,-329315.377000),
          (-276690.292000,-272442.175000)]
soft_2 = [(-163904.353000,-166883.865000),
          (-276690.292000,-272442.175000),
          (-163904.353000,-166883.865000),
          (-163904.353000,-166883.865000),
          (-253875.557000,-253946.867000),
          (-276066.554000,-276562.674000),
          (-231770.781000,-231876.742000),
          (-163904.353000,-166883.865000),
          (-234838.846000,-232699.755000),
          (-253875.557000,-253946.867000),
          (-330522.395000,-326155.223000),
          (-231770.781000,-231876.742000),
          (-234838.846000,-232699.755000),
          (-253822.821000,-254425.761000),
          (-237169.147000,-236070.148000),
          (-240159.410000,-241327.158000),
          (-274264.881000,-274464.580000),
          (-237631.983000,-236890.984000),
          (-261076.026000,-261387.675000),
          (-238137.847000,-235707.875000),
          (-264542.938000,-261638.556000),
          (-276066.554000,-276562.674000),
          (-276066.554000,-276562.674000),
          (-240159.410000,-241327.158000),
          (-163904.353000,-166883.865000),
          (-241738.203000,-243158.248000),
          (-240159.410000,-241327.158000),
          (-163904.353000,-166883.865000),
          (-260544.055000,-255138.157000),
          (-245529.143000,-246549.487000),
          (-276690.292000,-272442.175000),
          (-276690.292000,-272442.175000),
          (-220871.274000,-221579.254000),
          (-267864.761000,-268382.454000),
          (-237631.983000,-236890.984000),
          (-163904.353000,-166883.865000)]

hard_4 = [(-207176.651000,-203054.430000),
          (-143254.343000,-146111.138000),
          (-167524.556000,-167277.392000),
          (-353496.593000,-353725.682000),
          (-246921.145000,-247775.169000),
          (-125449.886000,-127202.266000),
          (-163904.353000,-166883.865000),
          (-216274.389000,-217884.852000),
          (-256630.480000,-249853.131000),
          (-250860.043000,-251759.893000),
          (-176881.886000,-177374.793000),
          (-151156.977000,-154911.231000),
          (-152975.865000,-152639.934000),
          (-163904.353000,-166883.865000),
          (-276684.492000,-277062.649000),
          (-205992.449000,-207745.238000),
          (-152745.171000,-150149.068000),
          (-141799.577000,-144813.740000),
          (-231770.781000,-231876.742000),
          (-169084.862000,-167755.542000),
          (-135711.449000,-139291.232000),
          (-204884.204000,-203544.547000),
          (-308214.029000,-309000.169000),
          (-268972.584000,-269925.266000),
          (-214915.226000,-215448.377000),
          (-202470.539000,-208004.874000),
          (-191199.638000,-189830.667000),
          (-320432.748000,-318963.813000),
          (-141799.577000,-144813.740000),
          (-176881.886000,-177374.793000),
          (-231770.781000,-231876.742000),
          (-199757.184000,-199744.479000),
          (-207607.573000,-206430.133000),
          (-254585.516000,-250372.050000)]
soft_4 = random.sample([(-189629.262000,-189347.427000),
          (-190828.367000,-193113.569000),
          (-231932.617000,-233126.938000),
          (-163904.353000,-166883.865000),
          (-188209.408000,-183564.400000),
          (-195337.773000,-197814.335000),
          (-167819.324000,-169051.878000),
          (-222326.040000,-222876.652000),
          (-231770.781000,-231876.742000),
          (-155966.095000,-158906.201000),
          (-185996.797000,-185441.571000),
          (-141799.577000,-144813.740000),
          (-148166.643000,-148644.873000),
          (-215421.090000,-214265.268000),
          (-163904.353000,-166883.865000),
          (-238137.847000,-235707.875000),
          (-276690.292000,-272442.175000),
          (-136808.204000,-137923.508000),
          (-141799.577000,-144813.740000),
          (-220361.656000,-215613.372000),
          (-152745.171000,-150149.068000),
          (-191199.638000,-189830.667000),
          (-163904.353000,-166883.865000),
          (-207858.240000,-203807.029000),
          (-189629.262000,-189347.427000),
          (-189629.262000,-189347.427000),
          (-138197.262000,-139174.900000),
          (-151156.977000,-154911.231000),
          (-199763.332000,-198594.912000),
          (-234838.846000,-232699.755000),
          (-251138.236000,-250124.976000),
          (-254585.516000,-250372.050000),
          (-288788.709000,-286775.102000),
          (-219868.415000,-221594.708000),
          (-155966.095000,-158906.201000)],sz)


ax = None
def simulate_curve(random_samples,c,labeled,l):
    x = np.arange(1,1+len(random_samples))
    y = []
    best = (-float('inf'),-float('inf'))
    for training,test in random.sample(random_samples,len(random_samples)):
        if training > best[0]:
            best = (training,test)
        y.append(best[1]/2500)
    ax.plot(x,np.array(y),'--',color = c,alpha = 0.2)

fig = figure(figsize = (4,3))
ax = fig.add_subplot(111)
ax.tick_params(axis = 'both',labelsize = 9)
#p.tick_params(axis='both', which='minor', labelsize=8)
for j in range(100): simulate_curve(hard_6,'b',j == 1,'6 lexemes')
for j in range(100): simulate_curve(hard_2,'r',j == 1,'2 lexemes')
for j in range(100): simulate_curve(hard_4,'g',j == 1,'4 lexemes')
ylabel('Heldout Log Likelihood/Lexeme',fontsize = 9)
xlabel('RANSAC iterations',fontsize = 9)
ylim([-140, -20])
code = [('b','6 lexemes'),
        ('g','4 lexemes'),
        ('r','2 lexemes')]
things = [mpatches.Rectangle((0,0),1,1,fc = k) for k,l in code ]
legend(things,[l for k,l in code ],loc = 4,fontsize = 9)
show()
savefig('hard.png')


fig = figure(figsize = (4,3))
ax = fig.add_subplot(111)
ax.tick_params(axis = 'both',labelsize = 11)
for j in range(50): simulate_curve(soft_4,'r',j == 1,'4 lexemes')
for j in range(50): simulate_curve(soft_5,'y',j == 1,'5 lexemes')
for j in range(50): simulate_curve(soft_6,'b',j == 1,'6 lexemes')
for j in range(50): simulate_curve(soft_7,'g',j == 1,'7 lexemes')


ylabel('Heldout Log Likelihood/Lexeme',fontsize = 11)
xlabel('RANSAC iterations',fontsize = 11)
ylim([-140, -20])
xlim([1,12])
code = [('g','7 lexemes'),
        ('b','6 lexemes'),
        ('y','5 lexemes'),
        ('r','4 lexemes')]
things = [mpatches.Rectangle((0,0),1,1,fc = k) for k,l in code ]
legend(things,[l for k,l in code ],loc = 4,fontsize = 11)
show()


savefig('soft.png')



